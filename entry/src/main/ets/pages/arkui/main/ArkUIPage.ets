import { ListItemVO } from './vo/ListItemVO';
import { Logger } from '@darren/common';
import { NavConstants } from '../../../constant/NavConstants';
import { HMRouterMgr } from '@hadss/hmrouter';
import { PageConstants } from '../../../constant/PageConstants';
import { ListGroupVO } from './vo/ListGroupVO';

@Styles
function fullParent() {
  .width('100%').height('100%')
}

@Styles
function allBorder () {
  .border({ width: 0.5, color: Color.Grey, style: BorderStyle.Solid })
}

@ComponentV2
export struct ArkUIPage {
  @Local isEditing: boolean = false;
  @Local selectItem: number = -1;
  @Local itemExpanded: boolean = false;
  groupVOList: Array<ListGroupVO> = this.initListData();

  @Builder
  groupItemHead(text: string, index: number) {
    Row() {
      Image($r('app.media.expanded'))
        .width(12)
        .height(12)
        .margin({ left: 10 })
        .rotate({
          x: 0,
          y: 0,
          z: 1,
          centerX: '50%',
          centerY: '50%',
          angle: this.selectItem == index ? 90 : 0
        })
      Text(text)
        .fontSize(14)
        .fontColor($r('app.color.text_primary'))
        .margin({ left: 8, top: 8, bottom: 8 })
    }
    .width('100%')
    .backgroundColor($r('app.color.white'))
    .justifyContent(FlexAlign.Start)
    .onClick(() => {
      animateTo({
        duration: 200,
        onFinish: () => {
          console.info('animation end');
        }
      }, () => {
        if (this.selectItem == index && this.itemExpanded) {
          this.selectItem = -1
          this.itemExpanded = false
        } else {
          this.selectItem = index;
          this.itemExpanded = true
        }
      })
    })
  }

  build() {
    Column() {
      List() {
        // é¡¶éƒ¨å¯¼èˆªæ å ä½
        ListItem() {}
        .width('100%')
        .height(NavConstants.APP_BAR_HEIGHT)

        // é¡¶éƒ¨æœç´¢ğŸ”
        ListItem() {
          Row() {
            TextInput({ placeholder: this.isEditing ? null : 'æœç´¢' })
              .fullParent()
              .placeholderColor('#9e9e9e')
              .showUnderline(false)
              .textAlign(this.isEditing ? TextAlign.Start : TextAlign.Center)
              .borderRadius(4)
              .backgroundColor($r('app.color.main_background'))
              .onChange((value: string) => {
                Logger.debug('onChange > > > value: ' + value)
              })
              .onEditChange((isEditing: boolean) => {
                this.isEditing = isEditing
                Logger.debug('isEditing > > > isEditing: ' + isEditing)
              })
          }
          .width('100%')
          .height(50)
          .padding(8)
          .backgroundColor($r('app.color.white'))
        }

        // Groupæ§ä»¶åˆ—è¡¨
        ForEach(this.groupVOList, (item: ListGroupVO, index: number) => {
          ListItemGroup({ header: this.groupItemHead(item.title, index) }) {
            if (this.selectItem == index) {
              ForEach(item.itemVOList, (listItemVO: ListItemVO, index: number) => {
                ListItem() {
                  Column() {
                    Row() {
                      Row() {
                        SymbolGlyph(listItemVO.icon)
                          .fontSize(30)
                          .fontWeight(FontWeight.Bold)
                          .renderingStrategy(SymbolRenderingStrategy.MULTIPLE_COLOR)
                      }
                      .width(52)
                      .height(52)
                      .margin({ right: 8 })
                      .justifyContent(FlexAlign.Center)
                      //.globalBorder()

                      Column() {
                        Text(listItemVO.name)
                          .fontSize(16)
                          .fontWeight(FontWeight.Bold)
                          .margin({ bottom: 4 })
                        Text(listItemVO.desc)
                          .fontSize(14)
                          .fontColor(Color.Grey)
                          .maxLines(1)
                          .textOverflow( { overflow: TextOverflow.Ellipsis })
                      }
                      .layoutWeight(1)
                      .height('100%')
                      .justifyContent(FlexAlign.SpaceBetween)
                      .alignItems(HorizontalAlign.Start)
                      .padding({ top: 4, bottom: 4 })
                      //.globalBorder()
                    }
                    .width('100%')
                    .layoutWeight(1)
                    .padding({ left: 8, top: 4, right: 8, bottom: 4 })
                    //.globalBorder()

                    // åˆ†å‰²çº¿
                    // Row() {
                    //   Row() {}
                    //   .width(52)
                    //   .height(0.2)
                    //   .margin({ left: 8, right: 8 })
                    //   Row() {}
                    //   .width('100%')
                    //   .height(0.2)
                    //   .backgroundColor(Color.Grey)
                    //   .opacity(0.5)
                    // }
                  }
                  .width('100%')
                  .height(60)
                  .justifyContent(FlexAlign.Start)
                  .backgroundColor(Color.White)
                }
                .onClick(() => {
                  HMRouterMgr.push({ pageUrl: listItemVO.page, param: listItemVO })
                  Logger.debug('click item: ' + listItemVO.name)
                })
              })
            }
          }
        })

        // åº•éƒ¨å¯¼èˆªæ å ä½
        ListItem() {}
        .width('100%')
        .height(NavConstants.BOTTOM_NAV_HEIGHT)
      }
      .fullParent()
      .sticky(StickyStyle.Header)
      .scrollBar(BarState.Off)
      .edgeEffect(EdgeEffect.Spring, { alwaysEnabled: true })
    }
    .width('100%')
    .justifyContent(FlexAlign.Start)
    .backgroundColor($r('app.color.main_background'))
  }

  /**
   * åˆå§‹åŒ–ListGroupæ•°æ®
   */
  private initListData(): Array<ListGroupVO> {
    let groupVOList: Array<ListGroupVO> = new Array<ListGroupVO>()

    // ç»„ä»¶é€šç”¨ä¿¡æ¯
    let commonGroup: Array<ListItemVO> = new Array<ListItemVO>()
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "ç‚¹å‡»äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, 'https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-common-events-V5', 'https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-events-click-V5'));
    commonGroup.push(new ListItemVO($r('sys.symbol.card_badge_shield'), "è§¦æ‘¸äº‹ä»¶", "å½“æ‰‹æŒ‡åœ¨ç»„ä»¶ä¸ŠæŒ‰ä¸‹ã€æ»‘åŠ¨ã€æŠ¬èµ·æ—¶è§¦å‘ã€‚", PageConstants.ON_TOUCH_PAGE, 'https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-common-events-touch-screen-event-V5', 'https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-events-touch-V5#ontouch'));
    commonGroup.push(new ListItemVO($r('sys.symbol.calendar_17'), "æŒ‚è½½å¸è½½äº‹ä»¶", "æŒ‚è½½å¸è½½äº‹ä»¶æŒ‡ç»„ä»¶ä»ç»„ä»¶æ ‘ä¸ŠæŒ‚è½½ã€å¸è½½æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.COMPONENT_LIFECYCLE_PAGE, '', 'https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-events-show-hide-V5'));
    commonGroup.push(new ListItemVO($r('sys.symbol.arrow_down_right_and_arrow_up_left'), "æ‹–æ‹½äº‹ä»¶", "æ‹–æ‹½äº‹ä»¶æŒ‡ç»„ä»¶è¢«é•¿æŒ‰åæ‹–æ‹½æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.DRAGGABLE_PAGE, 'https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-common-events-drag-event-V5', 'https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-events-drag-drop-V5'));
    commonGroup.push(new ListItemVO($r('sys.symbol.align_bottom'), "æŒ‰é”®äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.bookmark'), "ç„¦ç‚¹äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.calendar'), "é¼ æ ‡äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "æ‚¬æµ®äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "æ— éšœç¢æ‚¬æµ®äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "ç»„ä»¶åŒºåŸŸå˜åŒ–äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "ç»„ä»¶å°ºå¯¸å˜åŒ–äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "ç»„ä»¶å¯è§åŒºåŸŸå˜åŒ–äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "ç»„ä»¶å¿«æ·é”®äº‹ä»¶", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "è‡ªå®šä¹‰äº‹ä»¶åˆ†å‘", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));
    commonGroup.push(new ListItemVO($r('sys.symbol.AI_spell_suggest'), "è‡ªå®šä¹‰äº‹ä»¶æ‹¦æˆª", "ç»„ä»¶è¢«ç‚¹å‡»æ—¶è§¦å‘çš„äº‹ä»¶ã€‚", PageConstants.ON_CLICK_PAGE, '', ''));

    // æ–‡æœ¬ä¸è¾“å…¥
    let textAndInputGroup: Array<ListItemVO> = new Array<ListItemVO>()
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI_translate'), "Text", "æ˜¾ç¤ºä¸€æ®µæ–‡æœ¬çš„ç»„ä»¶ã€‚", PageConstants.TEXT_PAGE, 'https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-common-components-text-display-V5', 'https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-basic-components-text-V5'));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI_flower'), "TextArea", "å¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ï¼Œå½“è¾“å…¥çš„æ–‡æœ¬å†…å®¹è¶…è¿‡ç»„ä»¶å®½åº¦æ—¶ä¼šè‡ªåŠ¨æ¢è¡Œæ˜¾ç¤ºã€‚é«˜åº¦æœªè®¾ç½®æ—¶ï¼Œç»„ä»¶æ— é»˜è®¤é«˜åº¦ï¼Œè‡ªé€‚åº”å†…å®¹é«˜åº¦ã€‚å®½åº¦æœªè®¾ç½®æ—¶ï¼Œé»˜è®¤æ’‘æ»¡æœ€å¤§å®½åº¦ã€‚", PageConstants.TEXT_AREA_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI_play'), "TextInput", "å•è¡Œæ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ã€‚", PageConstants.TEXT_INPUT_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.character_square'), "RichEditor", "æ”¯æŒå›¾æ–‡æ··æ’å’Œæ–‡æœ¬äº¤äº’å¼ç¼–è¾‘çš„ç»„ä»¶ã€‚", PageConstants.RICH_EDITOR_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI_search'), "Search", "æœç´¢æ¡†ç»„ä»¶ï¼Œé€‚ç”¨äºæµè§ˆå™¨çš„æœç´¢å†…å®¹è¾“å…¥æ¡†ç­‰åº”ç”¨åœºæ™¯ã€‚", PageConstants.SEARCH_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.boutique_book'), "Span", "ä½œä¸ºTextã€ContainerSpanç»„ä»¶çš„å­ç»„ä»¶ï¼Œç”¨äºæ˜¾ç¤ºè¡Œå†…æ–‡æœ¬çš„ç»„ä»¶ã€‚", PageConstants.SPAN_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.bookmark_on_bookmark'), "ImageSpan", "Textã€ContainerSpanç»„ä»¶çš„å­ç»„ä»¶ï¼Œç”¨äºæ˜¾ç¤ºè¡Œå†…å›¾ç‰‡ã€‚", PageConstants.IMAGE_SPAN_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.bag'), "ContainerSpan", "Textç»„ä»¶çš„å­ç»„ä»¶ï¼Œç”¨äºç»Ÿä¸€ç®¡ç†å¤šä¸ªSpanã€ImageSpançš„èƒŒæ™¯è‰²åŠåœ†è§’å¼§åº¦ã€‚", PageConstants.CONTAINER_SPAN_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI_keyboard'), "SymbolSpan", "ä½œä¸ºTextç»„ä»¶çš„å­ç»„ä»¶ï¼Œç”¨äºæ˜¾ç¤ºå›¾æ ‡å°ç¬¦å·çš„ç»„ä»¶ã€‚", PageConstants.SYMBOL_SPAN_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.calendar_02'), "SymbolGlyph", "æ˜¾ç¤ºå›¾æ ‡å°ç¬¦å·çš„ç»„ä»¶ã€‚", PageConstants.SYMBOL_GLYPH_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.application_relay'), "Hyperlink", "è¶…é“¾æ¥ç»„ä»¶ï¼Œç»„ä»¶å®½é«˜èŒƒå›´å†…ç‚¹å‡»å®ç°è·³è½¬ã€‚", PageConstants.HYPER_LINK_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI'), "RichText", "å¯Œæ–‡æœ¬ç»„ä»¶ï¼Œè§£æå¹¶æ˜¾ç¤ºHTMLæ ¼å¼æ–‡æœ¬ã€‚", PageConstants.RICH_TEXT_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.a_3fingers_slash'), "SelectionMenu", "æ–‡æœ¬é€‰æ‹©èœå•ï¼Œé€‚ç”¨äºå¯Œæ–‡æœ¬ç»„ä»¶é€šè¿‡bindSelectionMenuç»‘å®šè‡ªå®šä¹‰æ–‡æœ¬é€‰æ‹©èœå•ï¼Œå»ºè®®ç»‘å®šé¼ æ ‡å³é”®æˆ–è€…é¼ æ ‡é€‰ä¸­æ–¹å¼å¼¹å‡ºï¼Œä¸æ”¯æŒä½œä¸ºæ™®é€šç»„ä»¶å•ç‹¬ä½¿ç”¨ã€‚", PageConstants.SELECTION_MENU_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.AI_phone'), "å±æ€§å­—ç¬¦ä¸²", "æ–¹ä¾¿çµæ´»åº”ç”¨æ–‡æœ¬æ ·å¼çš„å¯¹è±¡ï¼Œå¯é€šè¿‡TextControllerä¸­çš„setStyledStringæ–¹æ³•ä¸Textç»„ä»¶ç»‘å®šï¼Œå¯é€šè¿‡RichEditorStyledStringControllerä¸­çš„setStyledStringæ–¹æ³•ä¸RichEditorç»„ä»¶ç»‘å®šã€‚", PageConstants.TEXT_PARMA_PAGE, '', ''));
    textAndInputGroup.push(new ListItemVO($r('sys.symbol.calendar'), "æ–‡æœ¬ç»„ä»¶å…¬å…±æ¥å£", " ", PageConstants.TEXT_INTERFACE_PAGE, '', ''));

    groupVOList.push(new ListGroupVO("ç»„ä»¶é€šç”¨ä¿¡æ¯", commonGroup));
    groupVOList.push(new ListGroupVO("è¡Œåˆ—ä¸å †å ", textAndInputGroup));
    groupVOList.push(new ListGroupVO("æ …æ ¼ä¸åˆ†æ ", textAndInputGroup));
    groupVOList.push(new ListGroupVO("æ»šåŠ¨ä¸æ»‘åŠ¨", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å¯¼èˆªä¸åˆ‡æ¢", textAndInputGroup));
    groupVOList.push(new ListGroupVO("æŒ‰é’®ä¸é€‰æ‹©", textAndInputGroup));
    groupVOList.push(new ListGroupVO("æ–‡æœ¬ä¸è¾“å…¥", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å›¾ç‰‡ä¸è§†é¢‘", textAndInputGroup));
    groupVOList.push(new ListGroupVO("ä¿¡æ¯å±•ç¤º", textAndInputGroup));
    groupVOList.push(new ListGroupVO("ç©ºç™½ä¸åˆ†éš”", textAndInputGroup));
    groupVOList.push(new ListGroupVO("ç”»å¸ƒç»˜åˆ¶", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å›¾å½¢ç»˜åˆ¶", textAndInputGroup));
    groupVOList.push(new ListGroupVO("æ¸²æŸ“ç»˜åˆ¶", textAndInputGroup));
    groupVOList.push(new ListGroupVO("æ ‡é¢˜æ ä¸å·¥å…·æ ", textAndInputGroup));
    groupVOList.push(new ListGroupVO("èœå•", textAndInputGroup));
    groupVOList.push(new ListGroupVO("åŠ¨ç”»", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å¼¹çª—", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å¡ç‰‡", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å®‰å…¨", textAndInputGroup));
    groupVOList.push(new ListGroupVO("ä¸»é¢˜", textAndInputGroup));
    groupVOList.push(new ListGroupVO("åŸå­åŒ–æœåŠ¡", textAndInputGroup));
    groupVOList.push(new ListGroupVO("è‡ªå®šä¹‰å ä½ç»„ä»¶", textAndInputGroup));
    groupVOList.push(new ListGroupVO("è‡ªå®šä¹‰ç»„ä»¶", textAndInputGroup));
    groupVOList.push(new ListGroupVO("çŠ¶æ€ç®¡ç†ä¸æ¸²æŸ“æ§åˆ¶", textAndInputGroup));
    groupVOList.push(new ListGroupVO("å…¬å…±å®šä¹‰", textAndInputGroup));

    return groupVOList
  }

}